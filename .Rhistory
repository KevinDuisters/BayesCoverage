mtext(4,"alpha")
# tail decay
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.05),lty=2,col="lightgrey")
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
#for(a in seq(0,1,0.05)){segments(x0=0,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bty="n")
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.05),lty=2,col="lightgrey")
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
for(a in seq(0,1,0.05)){segments(x0=0,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bty="n")
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.05),lty=2,col="lightgrey")
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="black",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.05),lty=2,col="lightgrey")
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.05),lty=2,col="lightgrey")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
# tail decay
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
# tail decay
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
pdf("Figures/figtail.pdf",width=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
dev.off()
setwd("~/surfdrive/Confidence (KD)/Git")
pdf("Figures/figtail.pdf",width=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld))
dev.off()
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.05),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.05)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
#legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
legend(x=0,y=0.9,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
#legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
plot(0,0,xlim=c(0,1),ylim=c(0,1),ylab="alpha",xlab="w",type="n",asp=1)
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=c(0,1),ylim=c(0,1),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
#legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="i",yaxs="i",asp=1)
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="i",yaxs="i",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
#legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
?par
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="e",yaxs="e",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
#legend("topleft",densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="s",yaxs="s",asp=1)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="s",yaxs="s",asp=1)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="r",yaxs="r",asp=1)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="i",yaxs="i",asp=1)
range(alphaseq)
range(wseq)
#----------------------------------------------------------------------------------------------------------------------------#
# Duisters, Schmidt-Hieber
# June 2019
#----------------------------------------------------------------------------------------------------------------------------#
# Figure tail decay
#----------------------------------------------------------------------------------------------------------------------------#
# load library
library(rmutil)
#----------------------------------------------------------------------------------------------------------------------------#
# settings
h <- 0.001
alphaseq <- seq(0,1,h)
wseq <- c(alphaseq,1)
#wseq <- seq(0.5,1,0.0005)
densities <- c("N(0,1)","t10","t5","t3","t2","Lap(0,1)","Cauchy(0,1)")
cols <- c("black","navy","blue","deepskyblue","cyan","red","magenta")
ltys <- c(6,1,1,1,1,3,5)
ld <- length(densities)
#----------------------------------------------------------------------------------------------------------------------------#
# result
mat <- matrix(NA,length(alphaseq),length(wseq))
rownames(mat) <- alphaseq
colnames(mat) <- wseq
tail<- lapply(1:ld,function(l) mat)
#----------------------------------------------------------------------------------------------------------------------------#
# loop
for(d in 1:ld){
dens <- densities[d]
if(dens=="N(0,1)"){
#g <- function(x){dnorm(x,0,1)}
G <- function(x){pnorm(x,0,1)}
Ginv <- function(p){qnorm(p,0,1)}
}
if(dens=="t10"){
#g <- function(x){dt(x,10)}
G <- function(x){pt(x,10)}
Ginv <- function(p){qt(p,10)}
}
if(dens=="t5"){
#g <- function(x){dt(x,5)}
G <- function(x){pt(x,5)}
Ginv <- function(p){qt(p,5)}
}
if(dens=="t3"){
#g <- function(x){dt(x,3)}
G <- function(x){pt(x,3)}
Ginv <- function(p){qt(p,3)}
}
if(dens=="t2"){
#g <- function(x){dt(x,2)}
G <- function(x){pt(x,2)}
Ginv <- function(p){qt(p,2)}
}
if(dens=="Lap(0,1)"){
#g <- function(x){dlaplace(x)}
G <- function(x){plaplace(x)}
Ginv <- function(p){qlaplace(p)}
}
if(dens=="Cauchy(0,1)"){
#g <- function(x){dcauchy(x)}
G <- function(x){pcauchy(x)}
Ginv <- function(p){qcauchy(p)}
}
for(i in 1:(length(alphaseq)-1)){
alpha <- alphaseq[i]
for(j in (i+1):length(wseq)){
w <- wseq[j]
tail[[d]][i,j] <- (G(2*Ginv(alpha/w))<(2*alpha^2)/(1-alpha^2))
}
}
}
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="i",yaxs="i",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
range(wseq)
range(alphaseq)
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",xaxs="i",yaxs="i",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0.05,y=0.95,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
ltys <- c(4,1,1,1,1,3,5)
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=5,height=5)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
?pdf
8.7/2.54
pdf("Figures/figtail.pdf",width=3.5,height=3.5)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
pdf("Figures/figtail.pdf",width=9,height=9)
plot(0,0,xlim=range(wseq),ylim=range(alphaseq),ylab="alpha",xlab="w",type="n",asp=1)
polygon(x=c(-2,2,-2,-2),y=c(-2,2,2,-2),col="lightgrey",border="white")
abline(h=seq(0,1,0.1),lty=2,col="lightgrey")
abline(v=seq(0,1,0.1),lty=2,col="lightgrey")
for(a in seq(0,1,0.1)){segments(x0=-1,x1=a,y0=a,y1=a,lty=2,col="white")}
box()
for(d in 1:7){
alphaline <- apply(tail[[d]],2,function(c)alphaseq[min(which(c==T))])
lines(wseq,alphaline,lty=ltys[d],col=cols[d],lwd=2)
}
legend(x=0,y=1,densities[ld:1],lty=ltys[ld:1],col=cols[ld:1],lwd=rep(2,ld),bg="white")
dev.off()
57+31+47+25
57+27+47+25
53+27+47+25
51+27+47+25
shiny::runApp('~/Google Drive/3. LACDR/Human baseline study/HBT')
#--------------------------------------------------------------------------------------------------------------------#
# Plot Coverage
alpha <- 0.45
w=0.2
par(mfcol=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
#thetaseq <- seq(lambda+0.005,lambda+10,0.005)
thetaseq <- seq(lambda+0.005,lambda+30,0.05)
coverage(thetaseq,alpha,lambda,w,dist="Normal",plot.cov=T,cols=c("black","red","blue","orange","green"))
coverage(thetaseq,alpha,lambda,w,dist="Lap",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
setwd("~/surfdrive/Confidence (KD)/Git")
#--------------------------------------------------------------------------------------------------------------------#
# On frequentist coverage of Bayesian credible sets for estimation of the mean under constraints
# Duisters & Schmidt-Hieber
# Math Institute, Leiden University
# May 2019
#--------------------------------------------------------------------------------------------------------------------#
#--------------------------------------------------------------------------------------------------------------------#
# libraries
library(rmutil) #dlaplace
# source functions
source("functions/getU.R")
source("functions/coverage.R")
#--------------------------------------------------------------------------------------------------------------------#
# Plot Coverage
alpha <- 0.45
w <- 1
w=0.2
par(mfcol=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
#thetaseq <- seq(lambda+0.005,lambda+10,0.005)
thetaseq <- seq(lambda+0.005,lambda+30,0.05)
coverage(thetaseq,alpha,lambda,w,dist="Normal",plot.cov=T,cols=c("black","red","blue","orange","green"))
coverage(thetaseq,alpha,lambda,w,dist="Lap",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
thetaseq <- seq(lambda+0.005,lambda+10,0.005)
coverage(thetaseq,alpha,lambda,w,dist="t5",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="t3",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="Cauchy",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
par(mfrow=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
thetaseq <- seq(lambda+0.005,lambda+10,0.005)
coverage(thetaseq,alpha,lambda,w,dist="t5",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="t3",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="Cauchy",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
if(w==1){pdf("Figures/figcovbottom.pdf",width=9)}else{pdf("Figures/SFcovbottom.pdf",width=9)}
par(mfrow=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
thetaseq <- seq(lambda+0.005,lambda+10,0.005)
#coverage(thetaseq,alpha,lambda,w,dist="t5",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="t3",plot.cov=T,cols=c("black","red","blue","orange","green"))
coverage(thetaseq,alpha,lambda,w,dist="Cauchy",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
dev.off()
if(w==1){pdf("Figures/figcovbottom.pdf",width=9)}else{pdf("Figures/SFcovbottom.pdf",width=9)}
par(mfrow=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
thetaseq <- seq(lambda+0.005,lambda+10,0.005)
coverage(thetaseq,alpha,lambda,w,dist="t5",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="t3",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="Cauchy",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
dev.off()
w
alpha <- 0.05
w <- 1
w=0.2
#w=0.2 # Supplemental
if(w==1){pdf("Figures/figcovbottom.pdf",width=9)}else{pdf("Figures/SFcovbottom.pdf",width=9)}
par(mfrow=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
thetaseq <- seq(lambda+0.005,lambda+10,0.005)
coverage(thetaseq,alpha,lambda,w,dist="t5",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="t3",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="Cauchy",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
dev.off()
if(w==1){pdf("Figures/figcovbottom.pdf",width=9)}else{pdf("Figures/SFcovbottom.pdf",width=9)}
par(mfrow=c(2,2),xpd=F,mar=c(4,4,2,2))
lambdas <- c(0.75,7.5)
for(lambda in lambdas){
thetaseq <- seq(lambda+0.005,lambda+10,0.005)
#coverage(thetaseq,alpha,lambda,w,dist="t5",plot.cov=T,cols=c("black","red","blue","orange","green"))
coverage(thetaseq,alpha,lambda,w,dist="t3",plot.cov=T,cols=c("black","red","blue","orange","green"))
#coverage(thetaseq,alpha,lambda,w,dist="Cauchy",plot.cov=T,cols=c("black","red","blue","orange","green"))
}
dev.off()
